<!DOCTYPE HTML>
<!--
   Astral by HTML5 UP
   html5up.net | @ajlkn
   Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>RomanPick</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="{{ url_for('RomanPick', path='/assets/css/main.css') }}" />
	<noscript>
		<link rel="stylesheet" href="{{ url_for('RomanPick', path='assets/css/noscript.css') }}" />
	</noscript>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>

<body class="is-preload">

	<!-- Wrapper-->
	<div id="wrapper">

		<!-- Nav -->
		<nav id="nav">
			<a href="#home" class="icon solid fa-home" style="color: #D96A80;"><span>RomanPick</span></a>
			<a href="#barcode" class="icon solid fa-camera" style="color: #D96A80;"><span>Barcode</span></a>
			<a href="#emotion" class="icon solid fa-smile" style="color: #D96A80;"><span>Emotion</span></a>
			<a href="#game" class="icon solid fa-gamepad" style="color: #D96A80;"><span>Game</span></a>
		</nav>

		<!-- Main -->
		<div id="main">

			<!-- Me -->
			<article id="home" class="panel intro">
				<header>
					<div style="text-align:center;" id="cluster">
						<div class="label_back">
							<img src="{{ url_for('RomanPick', path='images/lable1.png') }}" alt="">
							<div class="image-container">
								<div class="image-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_red.png') }}" alt="">
									<div class="overlay">
										<span class="text">label1</span>
									</div>
								</div>
								<div class="image-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_purple.png') }}" alt="">
									<div class="overlay">
										<span class="text">label2</span>
									</div>
								</div>
								<div class="image-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_orange.png') }}" alt="">
									<div class="overlay">
										<span class="text">label3</span>
									</div>
								</div>
								<div class="image-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_yellow.png') }}" alt="">
									<div class="overlay">
										<span class="text">label4</span>
									</div>
								</div>
								<div class="image-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_green.png') }}" alt="">
									<div class="overlay">
										<span class="text">label5</span>
									</div>
								</div>
								<div class="image-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_blue.png') }}" alt="">
									<div class="overlay">
										<span class="text">label6</span>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div id="cluster-data" style="display:none">
						<nav id="nav">
							<a href="#"><i class="fas fa-heart" style="color: #F85B6C;"></i><span>label1</span></a>
							<a href="#"><i class="fas fa-heart" style="color: #C664F9;"></i><span>label2</span></a>
							<a href="#"><i class="fas fa-heart" style="color: #FBC774;"></i><span>label3</span></a>
							<a href="#"><i class="fas fa-heart" style="color: #FAED6D;"></i><span>label4</span></a>
							<a href="#"><i class="fas fa-heart" style="color: #3BE0D9;"></i><span>label5</span></a>
							<a href="#"><i class="fas fa-heart" style="color: #5CC6F6;"></i><span>label6</span></a>
						</nav>
						<div style="text-align:center;">
	
							<div class="label_back">
								<div style="position: relative;">
									<img src="{{ url_for('RomanPick', path='images/lable1.png') }}" alt="">
	
									<button id="refreshButton" style="z-index: 1;">
										<i class="fas fa-sync-alt"></i>
									</button>
	
									<div class="canvas-container">
	
										<canvas id="textCanvas"></canvas>
	
									</div>
								</div>
	
								
	
							</div>
						</div>
					</div>
				</header>
				



				<article id="contact" class="panel" style="text-align: center; margin-bottom: 20px;">
					<form class="search" style="background:none;" action="/search" method="post">
						<div style="float: left; width: 30%; padding:10px;">
							<select style="background: none; text-align: center;" name="category">
								<option id="all" value="all">▼ 전 체</option>
								<option id="title" value="title"> 제 목</option>
								<option id="writer" value="writer"> 작 가</option>
								<option id="keyword" value="keyword"> 키워드</option>
							</select>
						</div>

						<div style="float: left; width: 40%; padding:10px;">
							<input class="enter" type="text" name="input_text" maxlength="255" placeholder="검색어 입력"
								onfocus="this.placeholder = ''" onblur="this.placeholder = '검색어 입력'"
								style="background: none; display:inline-block">
						</div>

						<div style="float: right; width: 30%; padding:10px; text-align: center;">
							<button class="img-btn" type="submit" name="click" value="" style="text-align: center;">
								<i class="fas fa-search"></i>
							</button>
						</div>
					</form>
				</article>
			</article>



			<!-- barcode -->
			<article id="barcode" class="panel">
				<header>
					<h2 style="font-size: 25px; color:#D96A80">[ 당신이 재밌게 읽은 책의 바코드를 알려주세요! ]</h2>
				</header>
				<p style="text-align: center; font-size: 20px;">
					당신의 취향과 유사한 웹소설을 추천해드릴게요
				</p>

				<section>
					<div class="row">
						<div class="camera">
							<!-- <img class="image fit" src="images/camera.png" alt=""> -->

							<div id="fileName" style="text-align: center;"></div> <!-- 파일 이름을 보여줄 div -->
							<div id="image-show" style="text-align: center;"></div> <!-- 이미지를 보여줄 div -->

							
								<div class="button" style="background: none;">
									<label for="chooseFile" style="color:#D96A80;">
										👉 DROP & CLICK HERE! 👈
									</label>
								</div>
								<input type="file" id="chooseFile" name="chooseFile" accept="image/*"
									onchange="loadFile(this)">
								<form method="get" enctype="multipart/form-data" style="text-align: center;" action="/input_isbn">
								<div class="num">
									<input id="isbn" name="isbn" type="text" placeholder="ISBN 식별번호 13자리"
										onfocus="this.placeholder = ''" onblur="this.placeholder = 'ISBN 식별번호 13자리'">
								</div>

								<div id="drop"> 
									<i class="fas fa-camera" style="font-size: 100px;"></i>
								</div>

								<input type="button" id="btnSubmit" value="OK" />

							</form>
						</div>
					</div>
				</section>
			</article>

			<!-- emotion -->
			<article id="emotion" class="panel">
				<header>
					<h2 style="font-size: 25px; color:#D96A80">[ 오늘 당신의 기분은 어떠신가요? ]</h2>
				</header>

				<header  style="height: 500px;">
					<div style="text-align:center;">
				
						<!-- Nav -->
						<nav id="emo_nav">
							<div class="icon-container">
								<a href="#" class="icon solid fas fa-laugh-beam" style="color: #D96A80;">
									<span>기쁨</span>
								</a>
									<div class="dropdown-content">
										<a href="#">서브 메뉴</a>
										<a href="#">서브 메뉴2</a>
										<a href="#">서브 메뉴3</a>
									</div>
								
							</div>
							<div class="icon-container">
								<a href="#" class="icon solid fas fa-flushed" style="color: #D96A80;">
									<span>당황</span>
								</a>
									<div class="dropdown-content">
										<a href="#">서브 메뉴</a>
										<a href="#">서브 메뉴2</a>
										<a href="#">서브 메뉴3</a>
									</div>
								
							</div>
							<div class="icon-container">
								<a href="#" class="icon solid fas fa-frown-open" style="color: #D96A80;">
									<span>상처</span>
								</a>
									<div class="dropdown-content">
										<a href="#">서브 메뉴</a>
										<a href="#">서브 메뉴2</a>
										<a href="#">서브 메뉴3</a>
									</div>
								
							</div>
							<div class="icon-container">
								<a href="#" class="icon solid fas fa-grimace" style="color: #D96A80;">
									<span>불안</span>
								</a>
									<div class="dropdown-content">
										<a href="#">서브 메뉴</a>
										<a href="#">서브 메뉴2</a>
										<a href="#">서브 메뉴3</a>
									</div>
								
							</div>
							<div class="icon-container">
								<a href="#" class="icon solid fas fa-sad-cry" style="color: #D96A80;">
									<span>슬픔</span>
								</a>
									<div class="dropdown-content">
										<a href="#">서브 메뉴</a>
										<a href="#">서브 메뉴2</a>
										<a href="#">서브 메뉴3</a>
									</div>
								
							</div>
							<div class="icon-container">
								<a href="#" class="icon solid fas fa-angry" style="color: #D96A80;">
									<span>분노</span>
								</a>
									<div class="dropdown-content">
										<a href="#">서브 메뉴</a>
										<a href="#">서브 메뉴2</a>
										<a href="#">서브 메뉴3</a>
									</div>
								
							</div>
						</nav>
						  

						<!-- <nav id="nav">
							<a href="" class="icon solid fas fa-laugh-beam" style="color: #D96A80;"><span>기쁨</span></a>
							<a href="#" class="icon solid fas fa-flushed" style="color: #D96A80;"><span>당황</span></a>
							<a href="#" class="icon solid fas fa-frown-open" style="color: #D96A80;"><span>상처</span></a>
							<a href="#" class="icon solid fas fa-grimace" style="color: #D96A80;"><span>불안</span></a>
							<a href="#" class="icon solid fas fa-sad-cry" style="color: #D96A80;"><span>슬픔</span></a>
							<a href="#" class="icon solid fas fa-angry" style="color: #D96A80;"><span>분노</span></a>
						</nav> -->

						<!-- <div class="label_back">
							<img src="{{ url_for('RomanPick', path='images/lable1.png') }}" alt="">
							<div class="image-container" id="emotion-container">
								<div class="emotion-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_red.png') }}" alt="">
									<div class="overlay">
										<span class="text">Red Image</span>
									</div>
								</div>
								<div class="emotion-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_purple.png') }}" alt="">
									<div class="overlay">
										<span class="text">Purple Image</span>
									</div>
								</div>
								<div class="emotion-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_orange.png') }}" alt="">
									<div class="overlay">
										<span class="text">Orange Image</span>
									</div>
								</div>
								<div class="emotion-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_yellow.png') }}" alt="">
									<div class="overlay">
										<span class="text">Yellow Image</span>
									</div>
								</div>
								<div class="emotion-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_green.png') }}" alt="">
									<div class="overlay">
										<span class="text">Green Image</span>
									</div>
								</div>
								<div class="emotion-item">
									<img class="thumbnail" src="{{ url_for('RomanPick', path='images/l_blue.png') }}" alt="">
									<div class="overlay">
										<span class="text">Blue Image</span>
									</div>
								</div>
							</div>
						</div> -->
					</div>
				</header>
			</article>

			<!-- Me -->
			<article id="game" class="panel intro">
				<header>
					<div style="text-align: center;">
						<h1>연애시뮬레이션 공간</h1>
						<p>Senior Astral Projectionist</p>
					</div>
				</header>
				<header>
					<div style="text-align: center;">
						<h1>퍼즐 공간</h1>
						<p>Senior Astral Projectionist</p>
					</div>
				</header>
			</article>

		</div>

		

	</div>

	<!-- Scripts -->
	<!-- <script src="{{ url_for('RomanPick', path='assets/js/jquery.min.js') }}"></script> -->
	<script src="{{ url_for('RomanPick', path='assets/js/browser.min.js') }}"></script>
	<script src="{{ url_for('RomanPick', path='assets/js/breakpoints.min.js') }}"></script>
	<script src="{{ url_for('RomanPick', path='assets/js/util.js') }}"></script>
	<script src="{{ url_for('RomanPick', path='assets/js/main.js') }}"></script>
	<script>
		

		function Searching() {
			this.keyword = document.querySelector('input[name = "search"]');
			this.engine = document.querySelector('.SelectSearch');
			this.button = document.querySelector('.img-button');
			this.form = document.querySelector('.search');
		}
	</script>

	<!-- 하트 이미지 클릭하면 동적테스트 페이지로 이동 -->
	<script>
		// 라벨에 따른 랜덤 데이터 생성, 캔버스 출력 ajax 함수
		function label_random_data(label) {
			// 캔버스 초기화
			$('.canvas-container').empty();
			var canvas = $('<canvas></canvas>').attr('id', 'textCanvas');
			$('.canvas-container').append(canvas);
			// 라벨의 데이터 불러오기
			$.ajax({
			url : "/main/"+label,
			type:"get",
			success:function(data){
				// 라벨에서 랜덤한 데이터(제목, 줄거리 키워드) 
				// canvas에 텍스트 데이터 저장
				$.ajax({
					url:"{{ url_for('RomanPick', path='assets/js/canvas.js') }}",
					dataType:'script',
					success:function(result){
						create_canvas(data.textList,label)
						// 브라우저 사이즈 조정 시 캔버스 크기도 조정
						$(window).on('resize', function() {
							$('.canvas-container').empty();
							var canvas = $('<canvas></canvas>').attr('id', 'textCanvas');
							$('.canvas-container').append(canvas);
							create_canvas(data.textList,label);
						});
					}
				})
			}
		})
	}
	$('#cluster-data #nav a').click(function(e){
		e.preventDefault();
		if($(this).hasClass('active')){
			return;
		}else{
			// 다른 라벨 선택 시 해당 라벨에 대한 canvas 출력
			$('#cluster-data #nav a').removeClass('active');
			$(this).addClass('active');
			var changeLabel = $(this).children('span').text();
			label_random_data(changeLabel);
		}
	})
		$('.image-item').click(function(e){
			e.preventDefault();
			var label = $(this).find('.text').text();
			label_random_data(label)
			$('#cluster').css('display', 'none');
			$('#contact').css('display', 'none');
			$('#cluster-data').toggle();
			$('#cluster-data #nav a span').each(function() {
				if ($(this).text() == label) {
				  $(this).parent('a').addClass('active');
				}
			  });
			$('#refreshButton').click(function(e){
				label_random_data(label)
			})
		});
		
	</script>

	<!-- 바코드 사진업로드 -->
	<script>
		


		function loadFile(input) {
			var file = input.files[0];   //선택된 파일 가져오기
			var allowedExtensions = ['jpg', 'jpeg', 'png', 'gif'];
			var fileExtension = file.name.split('.').pop().toLowerCase();

		  if (allowedExtensions.includes(fileExtension)) {
			  var formData = new FormData();
			  formData.append('imageFile', file);

			  // 미리 만들어 놓은 div에 text(파일 이름) 추가
			  $('#fileName').text(file.name);
		  
			  // 새로운 이미지 생성
			  var newImage = $('<img>').addClass('img');
		  
			  // 이미지 source 가져오기
			  newImage.attr('src', URL.createObjectURL(file));
		  
			  newImage.css({
			  width: '70%',
			  height: '70%',
			  objectFit: 'contain',
			  visibility: 'hidden' // 초기에는 숨겨진 상태로 설정
			  });
		  
			  // 이미지를 image-show div에 추가
			  $('#image-show').empty().append(newImage);
		  
			  newImage.on('load', function () {
			  newImage.css('visibility', 'visible'); // 이미지 로딩 완료 후 보이도록 설정
			  });

			  $.ajax({
				url:"/img_barcode",
				type:"post",
				processData: false,
    			contentType: false,
				data:formData,
				success:function(result){
					if(result.result){
						if(result.book_code == "8"){
							var qs = $.param(result);
							window.location.href = "/barcode?"+ qs;
						}else{
							alert("대상 책이 문학 장르가 아니라 추천이 어렵습니다.");
							$('#fileName').text("");
							$('#image-show').children('.img').remove();
						}
					}else{
						alert("바코드를 인식할 수 없습니다.");
						$('#fileName').text("");
						$('#image-show').children('.img').remove();
					}
				}
			  })
		  }else{
			  alert('이미지 파일만 업로드 가능합니다.');
		  }


		};
		$(document).ready(function () {
			var dropArea = $('#barcode');
			var dropEvent = $('.button')
			$('body').on({
				'drop': function(e){
					e.preventDefault();
					dropEvent.removeClass('dragging');
					dropEvent.children('label').text('👉 DROP & CLICK HERE! 👈')
				},
				'dragover':function(e){
					e.preventDefault();
				}
			})
			dropArea.on({
				'dragover': function (e) {
			  		e.preventDefault();
					dropEvent.children('label').text('👉 DROP & CLICK HERE! 👈')
			  		dropEvent.addClass('dragging')
				},
				'dragleave': function(e){
					e.preventDefault();
					dropEvent.children('label').text('👉 취소 👈');
					setTimeout(function() {
						dropEvent.removeClass('dragging');
						dropEvent.children('label').text('👉 DROP & CLICK HERE! 👈')
					}, 3000);
					
				},
				'drop': function (e) {
					e.preventDefault();
					dropEvent.removeClass('dragging')
					
					// 이미지 소스를 이용해 바코드 판별
					loadFile(e.originalEvent.dataTransfer)
				}
			});
			dropArea.on();
		  });
		  
		  $('#image-show').on({
			'click': function(){
				$('#fileName').text("");
				$('#image-show').children('.img').remove();
			}
		  });
		  
	</script>
	<!-- drag & drop -->
	<script>
		// 카메라 실행 이벤트
		$('#drop').click(function(){
			$.ajax({
				url : "/camera_start",
				type:"get",
				success:function(result){
					console.log(result)
				}
			})
		})
	</script>
</body>
</html>